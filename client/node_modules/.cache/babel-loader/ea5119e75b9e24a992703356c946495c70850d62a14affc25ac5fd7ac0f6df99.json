{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\User\\\\Documents\\\\Project\\\\Smart-roommate-app\\\\client\\\\src\\\\components\\\\Messages.js\",\n  _s = $RefreshSig$(),\n  _s2 = $RefreshSig$();\nimport React, { useEffect, useMemo, useState } from 'react';\nimport { useLocation, useNavigate } from 'react-router-dom';\nimport { FaUserFriends } from 'react-icons/fa';\nimport API from '../services/api';\nimport { DEFAULT_PROPERTY_IMAGE } from '../constants/propertyMedia';\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst useQuery = () => {\n  _s();\n  return new URLSearchParams(useLocation().search);\n};\n_s(useQuery, \"EuD9q2dZ34PfN/QO2OBhBzeMxmY=\", false, function () {\n  return [useLocation];\n});\nexport default function Messages() {\n  _s2();\n  const query = useQuery();\n  const navigate = useNavigate();\n  const [conversations, setConversations] = useState([]);\n  const [activeId, setActiveId] = useState(null);\n  const [messages, setMessages] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const [sending, setSending] = useState(false);\n  const [error, setError] = useState('');\n  const [composer, setComposer] = useState('');\n  const [currentUserId, setCurrentUserId] = useState(null);\n  const [groupOpen, setGroupOpen] = useState(false);\n  const [groupName, setGroupName] = useState('');\n  const [groupMembers, setGroupMembers] = useState([]);\n  const [groupError, setGroupError] = useState('');\n  const [editingName, setEditingName] = useState(false);\n  const [nameDraft, setNameDraft] = useState('');\n  const [nameError, setNameError] = useState('');\n  const loadConversations = async () => {\n    try {\n      const res = await API.get('/conversations');\n      setConversations(res.data || []);\n      return res.data || [];\n    } catch (err) {\n      var _err$response, _err$response$data;\n      console.error(err);\n      setError(((_err$response = err.response) === null || _err$response === void 0 ? void 0 : (_err$response$data = _err$response.data) === null || _err$response$data === void 0 ? void 0 : _err$response$data.message) || 'Unable to load conversations.');\n      return [];\n    }\n  };\n  const loadMessages = async conversationId => {\n    if (!conversationId) return;\n    try {\n      const res = await API.get(`/conversations/${conversationId}/messages`);\n      setMessages(res.data || []);\n    } catch (err) {\n      var _err$response2, _err$response2$data;\n      console.error(err);\n      setError(((_err$response2 = err.response) === null || _err$response2 === void 0 ? void 0 : (_err$response2$data = _err$response2.data) === null || _err$response2$data === void 0 ? void 0 : _err$response2$data.message) || 'Unable to load messages.');\n    }\n  };\n  useEffect(() => {\n    const bootstrap = async () => {\n      setLoading(true);\n      const recipient = query.get('recipient');\n      const property = query.get('property');\n      let meId = null;\n      try {\n        var _me$data;\n        const me = await API.get('/users/me');\n        meId = ((_me$data = me.data) === null || _me$data === void 0 ? void 0 : _me$data.id) || null;\n        setCurrentUserId(meId);\n      } catch (err) {\n        console.error(err);\n      }\n      if (recipient) {\n        try {\n          var _res$data;\n          const res = await API.post('/conversations', {\n            recipientId: Number(recipient),\n            propertyId: property ? Number(property) : null\n          });\n          const convoId = (_res$data = res.data) === null || _res$data === void 0 ? void 0 : _res$data.id;\n          const convos = await loadConversations();\n          if (meId !== null) {\n            setCurrentUserId(meId);\n          }\n          if (convoId) {\n            setActiveId(convoId);\n            await loadMessages(convoId);\n          } else if (convos.length) {\n            setActiveId(convos[0].id);\n            await loadMessages(convos[0].id);\n          }\n        } catch (err) {\n          var _err$response3, _err$response3$data;\n          console.error(err);\n          setError(((_err$response3 = err.response) === null || _err$response3 === void 0 ? void 0 : (_err$response3$data = _err$response3.data) === null || _err$response3$data === void 0 ? void 0 : _err$response3$data.message) || 'Unable to start conversation.');\n        } finally {\n          navigate('/messages', {\n            replace: true\n          });\n          setLoading(false);\n        }\n        return;\n      }\n      const convos = await loadConversations();\n      if (meId !== null) {\n        setCurrentUserId(meId);\n      }\n      if (convos.length) {\n        setActiveId(convos[0].id);\n        await loadMessages(convos[0].id);\n      }\n      setLoading(false);\n    };\n    bootstrap();\n  }, []);\n  const activeConversation = useMemo(() => conversations.find(conversation => conversation.id === activeId), [conversations, activeId]);\n  const otherMembers = useMemo(() => {\n    if (!activeConversation) return [];\n    return (activeConversation.members || []).filter(member => member.id !== currentUserId);\n  }, [activeConversation, currentUserId]);\n  const isGroupChat = useMemo(() => otherMembers.length > 1, [otherMembers.length]);\n  const displayTitle = useMemo(() => {\n    if (!activeConversation) return '';\n    if (activeConversation.name) return activeConversation.name;\n    if (otherMembers.length === 1) return otherMembers[0].name;\n    if (otherMembers.length > 1) return `${otherMembers[0].name} + ${otherMembers.length - 1}`;\n    return 'Conversation';\n  }, [activeConversation, otherMembers]);\n  const avatarMembers = useMemo(() => {\n    if (!activeConversation) return [];\n    if (otherMembers.length <= 1) return otherMembers;\n    return otherMembers.slice(0, 2);\n  }, [activeConversation, otherMembers]);\n  const handleSend = async () => {\n    if (!composer.trim() || !activeId) return;\n    setSending(true);\n    try {\n      await API.post(`/conversations/${activeId}/messages`, {\n        body: composer.trim()\n      });\n      setComposer('');\n      await loadMessages(activeId);\n      await loadConversations();\n    } catch (err) {\n      var _err$response4, _err$response4$data;\n      console.error(err);\n      setError(((_err$response4 = err.response) === null || _err$response4 === void 0 ? void 0 : (_err$response4$data = _err$response4.data) === null || _err$response4$data === void 0 ? void 0 : _err$response4$data.message) || 'Unable to send message.');\n    } finally {\n      setSending(false);\n    }\n  };\n  const knownContacts = useMemo(() => {\n    const map = new Map();\n    conversations.forEach(conversation => {\n      (conversation.members || []).forEach(member => {\n        if (member.id === currentUserId) return;\n        if (!map.has(member.id)) {\n          map.set(member.id, member);\n        }\n      });\n    });\n    return Array.from(map.values());\n  }, [conversations, currentUserId]);\n  const handleCreateGroup = async () => {\n    setGroupError('');\n    if (!groupMembers.length) {\n      setGroupError('Select at least one person to create a group.');\n      return;\n    }\n    try {\n      var _res$data2;\n      const res = await API.post('/conversations', {\n        memberIds: groupMembers,\n        name: groupName.trim() || 'New group'\n      });\n      const convoId = (_res$data2 = res.data) === null || _res$data2 === void 0 ? void 0 : _res$data2.id;\n      const convos = await loadConversations();\n      if (convoId) {\n        setActiveId(convoId);\n        await loadMessages(convoId);\n      } else if (convos.length) {\n        setActiveId(convos[0].id);\n        await loadMessages(convos[0].id);\n      }\n      setGroupOpen(false);\n      setGroupName('');\n      setGroupMembers([]);\n    } catch (err) {\n      var _err$response5, _err$response5$data;\n      console.error(err);\n      setGroupError(((_err$response5 = err.response) === null || _err$response5 === void 0 ? void 0 : (_err$response5$data = _err$response5.data) === null || _err$response5$data === void 0 ? void 0 : _err$response5$data.message) || 'Unable to create group.');\n    }\n  };\n  const handleSaveName = async () => {\n    if (!activeConversation) return;\n    const nextName = nameDraft.trim();\n    if (!nextName) {\n      setNameError('Name is required.');\n      return;\n    }\n    try {\n      await API.put(`/conversations/${activeConversation.id}`, {\n        name: nextName\n      });\n      await loadConversations();\n      setEditingName(false);\n      setNameError('');\n    } catch (err) {\n      var _err$response6, _err$response6$data;\n      console.error(err);\n      setNameError(((_err$response6 = err.response) === null || _err$response6 === void 0 ? void 0 : (_err$response6$data = _err$response6.data) === null || _err$response6$data === void 0 ? void 0 : _err$response6$data.message) || 'Unable to update group name.');\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"messages-page\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"messages-sidebar\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"messages-header\",\n        children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n          className: \"h5 mb-0\",\n          children: \"Messages\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 212,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"messages-actions\",\n          children: /*#__PURE__*/_jsxDEV(\"button\", {\n            type: \"button\",\n            className: \"btn btn-outline-secondary btn-sm\",\n            onClick: () => setGroupOpen(true),\n            children: [/*#__PURE__*/_jsxDEV(FaUserFriends, {\n              className: \"me-1\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 215,\n              columnNumber: 15\n            }, this), \"New group\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 214,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 213,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 211,\n        columnNumber: 9\n      }, this), loading ? /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"text-muted\",\n        children: \"Loading conversations...\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 221,\n        columnNumber: 11\n      }, this) : conversations.length ? /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"messages-list\",\n        children: conversations.map(conversation => {\n          const memberList = (conversation.members || []).filter(member => member.id !== currentUserId);\n          const isGroup = memberList.length > 1;\n          const previewTitle = conversation.name ? conversation.name : memberList.length === 1 ? memberList[0].name : memberList.length ? `${memberList[0].name} + ${memberList.length - 1}` : 'Conversation';\n          const previewAvatars = isGroup ? memberList.slice(0, 2) : memberList.slice(0, 1);\n          const extraCount = isGroup && memberList.length > 2 ? memberList.length - 2 : 0;\n          return /*#__PURE__*/_jsxDEV(\"button\", {\n            type: \"button\",\n            className: `messages-item ${conversation.id === activeId ? 'is-active' : ''}`,\n            onClick: async () => {\n              setActiveId(conversation.id);\n              await loadMessages(conversation.id);\n            },\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"messages-item-avatar\",\n              children: [previewAvatars.map(member => /*#__PURE__*/_jsxDEV(\"img\", {\n                src: member.profile_image_url || DEFAULT_PROPERTY_IMAGE,\n                alt: member.name\n              }, member.id, false, {\n                fileName: _jsxFileName,\n                lineNumber: 248,\n                columnNumber: 23\n              }, this)), extraCount > 0 && /*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"avatar-extra\",\n                children: [\"+\", extraCount]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 254,\n                columnNumber: 40\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 246,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"messages-item-content\",\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"messages-item-title\",\n                children: previewTitle\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 257,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"messages-item-preview\",\n                children: conversation.last_message || 'Start the conversation'\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 258,\n                columnNumber: 21\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 256,\n              columnNumber: 19\n            }, this)]\n          }, conversation.id, true, {\n            fileName: _jsxFileName,\n            lineNumber: 237,\n            columnNumber: 17\n          }, this);\n        })\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 223,\n        columnNumber: 11\n      }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"text-muted\",\n        children: \"No conversations yet.\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 265,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 210,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"messages-thread\",\n      children: [error && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"alert alert-warning\",\n        children: error\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 269,\n        columnNumber: 19\n      }, this), activeConversation ? /*#__PURE__*/_jsxDEV(_Fragment, {\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"messages-thread-header\",\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"messages-thread-title\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"messages-item-avatar large\",\n              children: [avatarMembers.map(member => /*#__PURE__*/_jsxDEV(\"img\", {\n                src: member.profile_image_url || DEFAULT_PROPERTY_IMAGE,\n                alt: member.name\n              }, member.id, false, {\n                fileName: _jsxFileName,\n                lineNumber: 276,\n                columnNumber: 21\n              }, this)), isGroupChat && otherMembers.length > 2 && /*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"avatar-extra\",\n                children: [\"+\", otherMembers.length - 2]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 283,\n                columnNumber: 21\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 274,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              children: !editingName ? /*#__PURE__*/_jsxDEV(_Fragment, {\n                children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n                  className: \"h5 mb-1\",\n                  children: displayTitle\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 289,\n                  columnNumber: 23\n                }, this), isGroupChat && /*#__PURE__*/_jsxDEV(\"button\", {\n                  type: \"button\",\n                  className: \"btn btn-link p-0 text-decoration-none\",\n                  onClick: () => {\n                    setNameDraft(activeConversation.name || '');\n                    setEditingName(true);\n                  },\n                  children: \"Edit group name\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 291,\n                  columnNumber: 25\n                }, this)]\n              }, void 0, true) : /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"group-name-edit\",\n                children: [/*#__PURE__*/_jsxDEV(\"input\", {\n                  type: \"text\",\n                  className: \"form-control\",\n                  value: nameDraft,\n                  onChange: event => setNameDraft(event.target.value),\n                  placeholder: \"Group name\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 305,\n                  columnNumber: 23\n                }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                  type: \"button\",\n                  className: \"btn btn-primary btn-sm\",\n                  onClick: handleSaveName,\n                  children: \"Save\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 312,\n                  columnNumber: 23\n                }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                  type: \"button\",\n                  className: \"btn btn-outline-secondary btn-sm\",\n                  onClick: () => {\n                    setEditingName(false);\n                    setNameError('');\n                  },\n                  children: \"Cancel\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 315,\n                  columnNumber: 23\n                }, this), nameError && /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"text-danger small mt-1\",\n                  children: nameError\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 325,\n                  columnNumber: 37\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 304,\n                columnNumber: 21\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 286,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 273,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 272,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"messages-thread-body\",\n          children: messages.length ? messages.map(message => /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"message-bubble\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"message-meta\",\n              children: message.sender_name\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 335,\n              columnNumber: 21\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              children: message.body\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 336,\n              columnNumber: 21\n            }, this)]\n          }, message.id, true, {\n            fileName: _jsxFileName,\n            lineNumber: 334,\n            columnNumber: 19\n          }, this)) : /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"text-muted\",\n            children: \"No messages yet. Say hello.\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 340,\n            columnNumber: 17\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 331,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"messages-thread-footer\",\n          children: [/*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"text\",\n            className: \"form-control\",\n            placeholder: \"Write a message\",\n            value: composer,\n            onChange: event => setComposer(event.target.value),\n            onKeyDown: event => {\n              if (event.key === 'Enter') {\n                handleSend();\n              }\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 344,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            type: \"button\",\n            className: \"btn btn-primary\",\n            onClick: handleSend,\n            disabled: sending,\n            children: \"Send\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 356,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 343,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true) : /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"messages-empty text-muted\",\n        children: \"Select a conversation to start chatting.\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 362,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 268,\n      columnNumber: 7\n    }, this), groupOpen && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"filter-modal\",\n      role: \"dialog\",\n      \"aria-modal\": \"true\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"filter-dialog\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"filter-header\",\n          children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n            className: \"h5 mb-0\",\n            children: \"Create a group\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 370,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            type: \"button\",\n            className: \"btn btn-link\",\n            onClick: () => setGroupOpen(false),\n            children: \"Close\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 371,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 369,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"filter-body\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"filter-field\",\n            children: [/*#__PURE__*/_jsxDEV(\"label\", {\n              className: \"form-label\",\n              children: \"Group name\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 377,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n              type: \"text\",\n              className: \"form-control\",\n              placeholder: \"Roommate group\",\n              value: groupName,\n              onChange: event => setGroupName(event.target.value)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 378,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 376,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"filter-field\",\n            children: [/*#__PURE__*/_jsxDEV(\"label\", {\n              className: \"form-label\",\n              children: \"Add people you already talked with\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 387,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"filter-city-grid\",\n              children: knownContacts.length ? knownContacts.map(contact => /*#__PURE__*/_jsxDEV(\"label\", {\n                className: \"filter-city-pill\",\n                children: [/*#__PURE__*/_jsxDEV(\"input\", {\n                  type: \"checkbox\",\n                  checked: groupMembers.includes(contact.id),\n                  onChange: event => {\n                    const checked = event.target.checked;\n                    setGroupMembers(prev => {\n                      if (checked) return [...prev, contact.id];\n                      return prev.filter(id => id !== contact.id);\n                    });\n                  }\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 392,\n                  columnNumber: 25\n                }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                  children: contact.name\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 403,\n                  columnNumber: 25\n                }, this)]\n              }, contact.id, true, {\n                fileName: _jsxFileName,\n                lineNumber: 391,\n                columnNumber: 23\n              }, this)) : /*#__PURE__*/_jsxDEV(\"p\", {\n                className: \"text-muted mb-0\",\n                children: \"No previous chats yet.\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 407,\n                columnNumber: 21\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 388,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 386,\n            columnNumber: 15\n          }, this), groupError && /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"alert alert-warning py-2\",\n            children: groupError\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 411,\n            columnNumber: 30\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 375,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"filter-footer\",\n          children: [/*#__PURE__*/_jsxDEV(\"button\", {\n            type: \"button\",\n            className: \"btn btn-outline-secondary\",\n            onClick: () => setGroupOpen(false),\n            children: \"Cancel\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 414,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            type: \"button\",\n            className: \"btn btn-primary\",\n            onClick: handleCreateGroup,\n            children: \"Create group\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 417,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 413,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 368,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 367,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 209,\n    columnNumber: 5\n  }, this);\n}\n_s2(Messages, \"khgpg638jnRSJTBVnyNOEY+3Kow=\", false, function () {\n  return [useQuery, useNavigate];\n});\n_c = Messages;\nvar _c;\n$RefreshReg$(_c, \"Messages\");","map":{"version":3,"names":["React","useEffect","useMemo","useState","useLocation","useNavigate","FaUserFriends","API","DEFAULT_PROPERTY_IMAGE","jsxDEV","_jsxDEV","Fragment","_Fragment","useQuery","_s","URLSearchParams","search","Messages","_s2","query","navigate","conversations","setConversations","activeId","setActiveId","messages","setMessages","loading","setLoading","sending","setSending","error","setError","composer","setComposer","currentUserId","setCurrentUserId","groupOpen","setGroupOpen","groupName","setGroupName","groupMembers","setGroupMembers","groupError","setGroupError","editingName","setEditingName","nameDraft","setNameDraft","nameError","setNameError","loadConversations","res","get","data","err","_err$response","_err$response$data","console","response","message","loadMessages","conversationId","_err$response2","_err$response2$data","bootstrap","recipient","property","meId","_me$data","me","id","_res$data","post","recipientId","Number","propertyId","convoId","convos","length","_err$response3","_err$response3$data","replace","activeConversation","find","conversation","otherMembers","members","filter","member","isGroupChat","displayTitle","name","avatarMembers","slice","handleSend","trim","body","_err$response4","_err$response4$data","knownContacts","map","Map","forEach","has","set","Array","from","values","handleCreateGroup","_res$data2","memberIds","_err$response5","_err$response5$data","handleSaveName","nextName","put","_err$response6","_err$response6$data","className","children","fileName","_jsxFileName","lineNumber","columnNumber","type","onClick","memberList","isGroup","previewTitle","previewAvatars","extraCount","src","profile_image_url","alt","last_message","value","onChange","event","target","placeholder","sender_name","onKeyDown","key","disabled","role","contact","checked","includes","prev","_c","$RefreshReg$"],"sources":["C:/Users/User/Documents/Project/Smart-roommate-app/client/src/components/Messages.js"],"sourcesContent":["import React, { useEffect, useMemo, useState } from 'react';\nimport { useLocation, useNavigate } from 'react-router-dom';\nimport { FaUserFriends } from 'react-icons/fa';\nimport API from '../services/api';\nimport { DEFAULT_PROPERTY_IMAGE } from '../constants/propertyMedia';\n\nconst useQuery = () => new URLSearchParams(useLocation().search);\n\nexport default function Messages() {\n  const query = useQuery();\n  const navigate = useNavigate();\n  const [conversations, setConversations] = useState([]);\n  const [activeId, setActiveId] = useState(null);\n  const [messages, setMessages] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const [sending, setSending] = useState(false);\n  const [error, setError] = useState('');\n  const [composer, setComposer] = useState('');\n  const [currentUserId, setCurrentUserId] = useState(null);\n  const [groupOpen, setGroupOpen] = useState(false);\n  const [groupName, setGroupName] = useState('');\n  const [groupMembers, setGroupMembers] = useState([]);\n  const [groupError, setGroupError] = useState('');\n  const [editingName, setEditingName] = useState(false);\n  const [nameDraft, setNameDraft] = useState('');\n  const [nameError, setNameError] = useState('');\n\n  const loadConversations = async () => {\n    try {\n      const res = await API.get('/conversations');\n      setConversations(res.data || []);\n      return res.data || [];\n    } catch (err) {\n      console.error(err);\n      setError(err.response?.data?.message || 'Unable to load conversations.');\n      return [];\n    }\n  };\n\n  const loadMessages = async (conversationId) => {\n    if (!conversationId) return;\n    try {\n      const res = await API.get(`/conversations/${conversationId}/messages`);\n      setMessages(res.data || []);\n    } catch (err) {\n      console.error(err);\n      setError(err.response?.data?.message || 'Unable to load messages.');\n    }\n  };\n\n  useEffect(() => {\n    const bootstrap = async () => {\n      setLoading(true);\n      const recipient = query.get('recipient');\n      const property = query.get('property');\n      let meId = null;\n      try {\n        const me = await API.get('/users/me');\n        meId = me.data?.id || null;\n        setCurrentUserId(meId);\n      } catch (err) {\n        console.error(err);\n      }\n      if (recipient) {\n        try {\n          const res = await API.post('/conversations', {\n            recipientId: Number(recipient),\n            propertyId: property ? Number(property) : null\n          });\n          const convoId = res.data?.id;\n          const convos = await loadConversations();\n          if (meId !== null) {\n            setCurrentUserId(meId);\n          }\n          if (convoId) {\n            setActiveId(convoId);\n            await loadMessages(convoId);\n          } else if (convos.length) {\n            setActiveId(convos[0].id);\n            await loadMessages(convos[0].id);\n          }\n        } catch (err) {\n          console.error(err);\n          setError(err.response?.data?.message || 'Unable to start conversation.');\n        } finally {\n          navigate('/messages', { replace: true });\n          setLoading(false);\n        }\n        return;\n      }\n\n      const convos = await loadConversations();\n      if (meId !== null) {\n        setCurrentUserId(meId);\n      }\n      if (convos.length) {\n        setActiveId(convos[0].id);\n        await loadMessages(convos[0].id);\n      }\n      setLoading(false);\n    };\n\n    bootstrap();\n  }, []);\n\n  const activeConversation = useMemo(\n    () => conversations.find((conversation) => conversation.id === activeId),\n    [conversations, activeId]\n  );\n\n  const otherMembers = useMemo(() => {\n    if (!activeConversation) return [];\n    return (activeConversation.members || []).filter((member) => member.id !== currentUserId);\n  }, [activeConversation, currentUserId]);\n\n  const isGroupChat = useMemo(() => otherMembers.length > 1, [otherMembers.length]);\n\n  const displayTitle = useMemo(() => {\n    if (!activeConversation) return '';\n    if (activeConversation.name) return activeConversation.name;\n    if (otherMembers.length === 1) return otherMembers[0].name;\n    if (otherMembers.length > 1) return `${otherMembers[0].name} + ${otherMembers.length - 1}`;\n    return 'Conversation';\n  }, [activeConversation, otherMembers]);\n\n  const avatarMembers = useMemo(() => {\n    if (!activeConversation) return [];\n    if (otherMembers.length <= 1) return otherMembers;\n    return otherMembers.slice(0, 2);\n  }, [activeConversation, otherMembers]);\n\n  const handleSend = async () => {\n    if (!composer.trim() || !activeId) return;\n    setSending(true);\n    try {\n      await API.post(`/conversations/${activeId}/messages`, { body: composer.trim() });\n      setComposer('');\n      await loadMessages(activeId);\n      await loadConversations();\n    } catch (err) {\n      console.error(err);\n      setError(err.response?.data?.message || 'Unable to send message.');\n    } finally {\n      setSending(false);\n    }\n  };\n\n  const knownContacts = useMemo(() => {\n    const map = new Map();\n    conversations.forEach((conversation) => {\n      (conversation.members || []).forEach((member) => {\n        if (member.id === currentUserId) return;\n        if (!map.has(member.id)) {\n          map.set(member.id, member);\n        }\n      });\n    });\n    return Array.from(map.values());\n  }, [conversations, currentUserId]);\n\n  const handleCreateGroup = async () => {\n    setGroupError('');\n    if (!groupMembers.length) {\n      setGroupError('Select at least one person to create a group.');\n      return;\n    }\n    try {\n      const res = await API.post('/conversations', {\n        memberIds: groupMembers,\n        name: groupName.trim() || 'New group'\n      });\n      const convoId = res.data?.id;\n      const convos = await loadConversations();\n      if (convoId) {\n        setActiveId(convoId);\n        await loadMessages(convoId);\n      } else if (convos.length) {\n        setActiveId(convos[0].id);\n        await loadMessages(convos[0].id);\n      }\n      setGroupOpen(false);\n      setGroupName('');\n      setGroupMembers([]);\n    } catch (err) {\n      console.error(err);\n      setGroupError(err.response?.data?.message || 'Unable to create group.');\n    }\n  };\n\n  const handleSaveName = async () => {\n    if (!activeConversation) return;\n    const nextName = nameDraft.trim();\n    if (!nextName) {\n      setNameError('Name is required.');\n      return;\n    }\n    try {\n      await API.put(`/conversations/${activeConversation.id}`, { name: nextName });\n      await loadConversations();\n      setEditingName(false);\n      setNameError('');\n    } catch (err) {\n      console.error(err);\n      setNameError(err.response?.data?.message || 'Unable to update group name.');\n    }\n  };\n\n  return (\n    <div className=\"messages-page\">\n      <div className=\"messages-sidebar\">\n        <div className=\"messages-header\">\n          <h1 className=\"h5 mb-0\">Messages</h1>\n          <div className=\"messages-actions\">\n            <button type=\"button\" className=\"btn btn-outline-secondary btn-sm\" onClick={() => setGroupOpen(true)}>\n              <FaUserFriends className=\"me-1\" />\n              New group\n            </button>\n          </div>\n        </div>\n        {loading ? (\n          <div className=\"text-muted\">Loading conversations...</div>\n        ) : conversations.length ? (\n          <div className=\"messages-list\">\n            {conversations.map((conversation) => {\n              const memberList = (conversation.members || []).filter((member) => member.id !== currentUserId);\n              const isGroup = memberList.length > 1;\n              const previewTitle = conversation.name\n                ? conversation.name\n                : memberList.length === 1\n                ? memberList[0].name\n                : memberList.length\n                ? `${memberList[0].name} + ${memberList.length - 1}`\n                : 'Conversation';\n              const previewAvatars = isGroup ? memberList.slice(0, 2) : memberList.slice(0, 1);\n              const extraCount = isGroup && memberList.length > 2 ? memberList.length - 2 : 0;\n              return (\n                <button\n                  key={conversation.id}\n                  type=\"button\"\n                  className={`messages-item ${conversation.id === activeId ? 'is-active' : ''}`}\n                  onClick={async () => {\n                    setActiveId(conversation.id);\n                    await loadMessages(conversation.id);\n                  }}\n                >\n                  <div className=\"messages-item-avatar\">\n                    {previewAvatars.map((member) => (\n                      <img\n                        key={member.id}\n                        src={member.profile_image_url || DEFAULT_PROPERTY_IMAGE}\n                        alt={member.name}\n                      />\n                    ))}\n                    {extraCount > 0 && <span className=\"avatar-extra\">+{extraCount}</span>}\n                  </div>\n                  <div className=\"messages-item-content\">\n                    <div className=\"messages-item-title\">{previewTitle}</div>\n                    <div className=\"messages-item-preview\">{conversation.last_message || 'Start the conversation'}</div>\n                  </div>\n                </button>\n              );\n            })}\n          </div>\n        ) : (\n          <div className=\"text-muted\">No conversations yet.</div>\n        )}\n      </div>\n      <div className=\"messages-thread\">\n        {error && <div className=\"alert alert-warning\">{error}</div>}\n        {activeConversation ? (\n          <>\n            <div className=\"messages-thread-header\">\n              <div className=\"messages-thread-title\">\n                <div className=\"messages-item-avatar large\">\n                  {avatarMembers.map((member) => (\n                    <img\n                      key={member.id}\n                      src={member.profile_image_url || DEFAULT_PROPERTY_IMAGE}\n                      alt={member.name}\n                    />\n                  ))}\n                  {isGroupChat && otherMembers.length > 2 && (\n                    <span className=\"avatar-extra\">+{otherMembers.length - 2}</span>\n                  )}\n                </div>\n                <div>\n                  {!editingName ? (\n                    <>\n                      <h2 className=\"h5 mb-1\">{displayTitle}</h2>\n                      {isGroupChat && (\n                        <button\n                          type=\"button\"\n                          className=\"btn btn-link p-0 text-decoration-none\"\n                          onClick={() => {\n                            setNameDraft(activeConversation.name || '');\n                            setEditingName(true);\n                          }}\n                        >\n                          Edit group name\n                        </button>\n                      )}\n                    </>\n                  ) : (\n                    <div className=\"group-name-edit\">\n                      <input\n                        type=\"text\"\n                        className=\"form-control\"\n                        value={nameDraft}\n                        onChange={(event) => setNameDraft(event.target.value)}\n                        placeholder=\"Group name\"\n                      />\n                      <button type=\"button\" className=\"btn btn-primary btn-sm\" onClick={handleSaveName}>\n                        Save\n                      </button>\n                      <button\n                        type=\"button\"\n                        className=\"btn btn-outline-secondary btn-sm\"\n                        onClick={() => {\n                          setEditingName(false);\n                          setNameError('');\n                        }}\n                      >\n                        Cancel\n                      </button>\n                      {nameError && <div className=\"text-danger small mt-1\">{nameError}</div>}\n                    </div>\n                  )}\n                </div>\n              </div>\n            </div>\n            <div className=\"messages-thread-body\">\n              {messages.length ? (\n                messages.map((message) => (\n                  <div key={message.id} className=\"message-bubble\">\n                    <div className=\"message-meta\">{message.sender_name}</div>\n                    <p>{message.body}</p>\n                  </div>\n                ))\n              ) : (\n                <div className=\"text-muted\">No messages yet. Say hello.</div>\n              )}\n            </div>\n            <div className=\"messages-thread-footer\">\n              <input\n                type=\"text\"\n                className=\"form-control\"\n                placeholder=\"Write a message\"\n                value={composer}\n                onChange={(event) => setComposer(event.target.value)}\n                onKeyDown={(event) => {\n                  if (event.key === 'Enter') {\n                    handleSend();\n                  }\n                }}\n              />\n              <button type=\"button\" className=\"btn btn-primary\" onClick={handleSend} disabled={sending}>\n                Send\n              </button>\n            </div>\n          </>\n        ) : (\n          <div className=\"messages-empty text-muted\">Select a conversation to start chatting.</div>\n        )}\n      </div>\n\n      {groupOpen && (\n        <div className=\"filter-modal\" role=\"dialog\" aria-modal=\"true\">\n          <div className=\"filter-dialog\">\n            <div className=\"filter-header\">\n              <h2 className=\"h5 mb-0\">Create a group</h2>\n              <button type=\"button\" className=\"btn btn-link\" onClick={() => setGroupOpen(false)}>\n                Close\n              </button>\n            </div>\n            <div className=\"filter-body\">\n              <div className=\"filter-field\">\n                <label className=\"form-label\">Group name</label>\n                <input\n                  type=\"text\"\n                  className=\"form-control\"\n                  placeholder=\"Roommate group\"\n                  value={groupName}\n                  onChange={(event) => setGroupName(event.target.value)}\n                />\n              </div>\n              <div className=\"filter-field\">\n                <label className=\"form-label\">Add people you already talked with</label>\n                <div className=\"filter-city-grid\">\n                  {knownContacts.length ? (\n                    knownContacts.map((contact) => (\n                      <label key={contact.id} className=\"filter-city-pill\">\n                        <input\n                          type=\"checkbox\"\n                          checked={groupMembers.includes(contact.id)}\n                          onChange={(event) => {\n                            const checked = event.target.checked;\n                            setGroupMembers((prev) => {\n                              if (checked) return [...prev, contact.id];\n                              return prev.filter((id) => id !== contact.id);\n                            });\n                          }}\n                        />\n                        <span>{contact.name}</span>\n                      </label>\n                    ))\n                  ) : (\n                    <p className=\"text-muted mb-0\">No previous chats yet.</p>\n                  )}\n                </div>\n              </div>\n              {groupError && <div className=\"alert alert-warning py-2\">{groupError}</div>}\n            </div>\n            <div className=\"filter-footer\">\n              <button type=\"button\" className=\"btn btn-outline-secondary\" onClick={() => setGroupOpen(false)}>\n                Cancel\n              </button>\n              <button type=\"button\" className=\"btn btn-primary\" onClick={handleCreateGroup}>\n                Create group\n              </button>\n            </div>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}