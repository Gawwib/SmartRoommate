{"ast":null,"code":"import _objectSpread from\"C:/Users/User/Documents/Project/Smart-roommate-app/client/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useEffect,useMemo,useState}from'react';import{useNavigate}from'react-router-dom';import API from'../services/api';import{DEFAULT_PROPERTY_IMAGE}from'../constants/propertyMedia';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const HABIT_OPTIONS=['Cinema','Football','Basketball','Tennis','Running','Cycling','Hiking','Swimming','Gym / Fitness','Yoga','Pilates','Cooking','Baking','Coffee shops','Tea lover','Wine tasting','Craft beer','Board games','Card games','Video games','Esports','Anime','Manga','Reading','Writing','Photography','Videography','Art galleries','Museums','Concerts','Live music','Festivals','Travel','Road trips','Camping','Beach days','Shopping','Thrifting','Fashion','Interior design','DIY projects','Gardening','Plants','Pets / Dogs','Pets / Cats','Volunteering','Meditation','Language learning','Tech & gadgets','Podcasts','Stand-up comedy','Dancing'];const MIN_HABITS=3;const MAX_HABITS=8;const BIO_LIMIT=30;const parseHabits=value=>(value||'').split(',').map(item=>item.trim()).filter(Boolean);const formatHabits=list=>list.join(', ');const calculateAge=birthdate=>{if(!birthdate)return null;const dob=new Date(birthdate);if(Number.isNaN(dob.getTime()))return null;const diff=Date.now()-dob.getTime();const ageDate=new Date(diff);return Math.abs(ageDate.getUTCFullYear()-1970);};const cropImageToSquare=function(url,centerPercent){let frameRatio=arguments.length>2&&arguments[2]!==undefined?arguments[2]:0.7;let outputSize=arguments.length>3&&arguments[3]!==undefined?arguments[3]:800;return new Promise((resolve,reject)=>{const img=new Image();img.crossOrigin='anonymous';img.onload=()=>{const{naturalWidth:w,naturalHeight:h}=img;const size=Math.min(w,h)*frameRatio;const centerX=centerPercent.x/100*w;const centerY=centerPercent.y/100*h;const startX=Math.min(Math.max(centerX-size/2,0),w-size);const startY=Math.min(Math.max(centerY-size/2,0),h-size);const canvas=document.createElement('canvas');canvas.width=outputSize;canvas.height=outputSize;const ctx=canvas.getContext('2d');ctx.drawImage(img,startX,startY,size,size,0,0,outputSize,outputSize);resolve(canvas.toDataURL('image/jpeg',0.9));};img.onerror=reject;img.src=url;});};export default function Profile(){const[profile,setProfile]=useState(null);const[form,setForm]=useState({birthdate:'',gender:'',location:'',bio:'',habits:[],profileImage:''});const[msg,setMsg]=useState('');const[error,setError]=useState('');const[loading,setLoading]=useState(true);const[saving,setSaving]=useState(false);const[uploading,setUploading]=useState(false);const[imagePosition,setImagePosition]=useState({x:50,y:50});const[showCropper,setShowCropper]=useState(false);const[tempImage,setTempImage]=useState('');const[isDragging,setIsDragging]=useState(false);const navigate=useNavigate();useEffect(()=>{const load=async()=>{try{const res=await API.get('/users/me');const interests=parseHabits(res.data.habits);setProfile(res.data);const savedPos=res.data.id&&localStorage.getItem(\"profileImagePos_\".concat(res.data.id))?JSON.parse(localStorage.getItem(\"profileImagePos_\".concat(res.data.id))):{x:50,y:50};setImagePosition(savedPos);setForm({birthdate:res.data.birthdate?res.data.birthdate.slice(0,10):'2003-01-01',gender:res.data.gender||'',location:res.data.location||'',bio:res.data.bio||'',habits:interests,profileImage:res.data.profile_image_url||''});}catch(err){var _err$response;if(((_err$response=err.response)===null||_err$response===void 0?void 0:_err$response.status)===401){setError('Please log in to view your profile.');}else{setError('Unable to load your profile right now.');}}finally{setLoading(false);}};load();},[]);const handleHabitToggle=habit=>{setForm(prev=>{const alreadySelected=prev.habits.includes(habit);if(alreadySelected){return _objectSpread(_objectSpread({},prev),{},{habits:prev.habits.filter(h=>h!==habit)});}if(prev.habits.length>=MAX_HABITS)return prev;return _objectSpread(_objectSpread({},prev),{},{habits:[...prev.habits,habit]});});};const handleChange=e=>setForm(_objectSpread(_objectSpread({},form),{},{[e.target.name]:e.target.value}));const persistProfileImage=async url=>{const age=calculateAge(form.birthdate||(profile===null||profile===void 0?void 0:profile.birthdate)||'2003-01-01');const payload={birthdate:(profile===null||profile===void 0?void 0:profile.birthdate)||'2003-01-01',age,gender:form.gender||(profile===null||profile===void 0?void 0:profile.gender)||null,location:form.location||(profile===null||profile===void 0?void 0:profile.location)||'',budget:null,habits:formatHabits(form.habits),profile_image_url:url,bio:form.bio||(profile===null||profile===void 0?void 0:profile.bio)||''};try{await API.put('/users/me',payload);setProfile(prev=>_objectSpread(_objectSpread({},prev),payload));}catch(err){var _err$response2,_err$response2$data;console.error(err);setError(((_err$response2=err.response)===null||_err$response2===void 0?void 0:(_err$response2$data=_err$response2.data)===null||_err$response2$data===void 0?void 0:_err$response2$data.message)||'Unable to save photo.');}};const handlePhotoUpload=async event=>{const files=Array.from(event.target.files||[]);if(!files.length)return;const formData=new FormData();formData.append('images',files[0]);try{var _res$data,_res$data$urls;setUploading(true);const res=await API.post('/uploads',formData,{headers:{'Content-Type':'multipart/form-data'}});const url=(_res$data=res.data)===null||_res$data===void 0?void 0:(_res$data$urls=_res$data.urls)===null||_res$data$urls===void 0?void 0:_res$data$urls[0];if(url){setForm(prev=>_objectSpread(_objectSpread({},prev),{},{profileImage:url}));setTempImage(url);setShowCropper(true);}}catch(err){var _err$response3,_err$response3$data;console.error(err);setError(((_err$response3=err.response)===null||_err$response3===void 0?void 0:(_err$response3$data=_err$response3.data)===null||_err$response3$data===void 0?void 0:_err$response3$data.message)||'Unable to upload photo.');}finally{setUploading(false);event.target.value='';}};const handleSubmit=async e=>{e.preventDefault();setMsg('');setError('');if(form.habits.length<MIN_HABITS||form.habits.length>MAX_HABITS){setError(\"Choose at least \".concat(MIN_HABITS,\" and at most \").concat(MAX_HABITS,\" interests.\"));return;}if(!form.gender){setError('Please select your gender.');return;}if(!form.bio.trim()){setError('Add a short bio about yourself (max 30 characters).');return;}if(form.bio.trim().length>BIO_LIMIT){setError('Bio must be 30 characters or fewer.');return;}const age=calculateAge(form.birthdate||(profile===null||profile===void 0?void 0:profile.birthdate)||'2003-01-01');const payload={birthdate:(profile===null||profile===void 0?void 0:profile.birthdate)||'2003-01-01',age,gender:form.gender||null,location:form.location||'',budget:null,habits:formatHabits(form.habits),profile_image_url:form.profileImage||(profile===null||profile===void 0?void 0:profile.profile_image_url)||null,bio:form.bio.trim()};try{setSaving(true);await API.put('/users/me',payload);setMsg('Profile updated');setProfile(prev=>_objectSpread(_objectSpread({},prev),payload));if(profile!==null&&profile!==void 0&&profile.id){localStorage.setItem(\"profileImagePos_\".concat(profile.id),JSON.stringify(imagePosition));}}catch(err){var _err$response4,_err$response4$data;console.error(err);setError(((_err$response4=err.response)===null||_err$response4===void 0?void 0:(_err$response4$data=_err$response4.data)===null||_err$response4$data===void 0?void 0:_err$response4$data.message)||'Unable to update profile right now.');}finally{setSaving(false);}};const ageDisplay=useMemo(()=>calculateAge(form.birthdate||(profile===null||profile===void 0?void 0:profile.birthdate)),[form.birthdate,profile]);const birthYear=useMemo(()=>profile!==null&&profile!==void 0&&profile.birthdate?new Date(profile.birthdate).getFullYear():null,[profile===null||profile===void 0?void 0:profile.birthdate]);const displayImage=form.profileImage||(profile===null||profile===void 0?void 0:profile.profile_image_url)||DEFAULT_PROPERTY_IMAGE;const handleCropSave=async()=>{try{const base=tempImage||displayImage;const cropped=await cropImageToSquare(base,imagePosition,0.65,800);setShowCropper(false);await persistProfileImage(cropped);setTempImage('');setForm(prev=>_objectSpread(_objectSpread({},prev),{},{profileImage:cropped}));if(profile!==null&&profile!==void 0&&profile.id){localStorage.setItem(\"profileImagePos_\".concat(profile.id),JSON.stringify(imagePosition));}}catch(err){console.error(err);setError('Unable to crop image.');setShowCropper(false);}};const handleCropCancel=()=>{setShowCropper(false);setTempImage('');};const startDrag=()=>setIsDragging(true);const endDrag=()=>setIsDragging(false);const onCropMove=e=>{if(!isDragging)return;const rect=e.currentTarget.getBoundingClientRect();const x=(e.clientX-rect.left)/rect.width*100;const y=(e.clientY-rect.top)/rect.height*100;setImagePosition({x:Math.min(100,Math.max(0,x)),y:Math.min(100,Math.max(0,y))});};if(loading)return/*#__PURE__*/_jsx(\"div\",{children:\"Loading...\"});if(error&&!profile){return/*#__PURE__*/_jsxs(\"div\",{className:\"alert alert-warning d-flex justify-content-between align-items-center\",children:[/*#__PURE__*/_jsx(\"span\",{children:error}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"btn btn-primary btn-sm\",onClick:()=>navigate('/login'),children:\"Go to login\"})]});}if(!profile)return null;return/*#__PURE__*/_jsxs(\"div\",{className:\"profile-page\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"profile-hero-card shadow-sm\",children:/*#__PURE__*/_jsx(\"div\",{className:\"profile-hero-image\",style:{backgroundImage:\"url(\".concat(displayImage,\")\"),backgroundPosition:'center',backgroundSize:'cover',backgroundRepeat:'no-repeat'},children:/*#__PURE__*/_jsxs(\"div\",{className:\"profile-hero-overlay\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex align-items-center gap-2 mb-2\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"status-dot\"}),/*#__PURE__*/_jsx(\"span\",{className:\"text-light small\",children:\"Online now\"})]}),/*#__PURE__*/_jsx(\"h2\",{className:\"text-light mb-1\",children:ageDisplay!==null?\"\".concat(profile.name,\", \").concat(ageDisplay):profile.name}),birthYear&&/*#__PURE__*/_jsxs(\"p\",{className:\"mb-1 text-light small\",children:[\"Born \",birthYear]}),profile.location&&/*#__PURE__*/_jsx(\"p\",{className:\"mb-1 text-light\",children:profile.location}),form.bio&&/*#__PURE__*/_jsx(\"p\",{className:\"mb-2 text-light fw-semibold\",children:form.bio}),form.habits.length>0&&/*#__PURE__*/_jsx(\"div\",{className:\"pill-row\",children:form.habits.slice(0,6).map(habit=>/*#__PURE__*/_jsx(\"span\",{className:\"pill pill-selected small\",children:habit},habit))})]})})}),/*#__PURE__*/_jsx(\"div\",{className:\"card border-0 shadow-sm\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"card-body\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"eyebrow text-uppercase mb-1\",children:\"Improve your matches\"}),/*#__PURE__*/_jsx(\"h3\",{className:\"h5\",children:\"Update profile\"}),msg&&/*#__PURE__*/_jsx(\"div\",{className:\"alert alert-info mt-2\",children:msg}),error&&profile&&/*#__PURE__*/_jsx(\"div\",{className:\"alert alert-warning mt-2\",children:error}),/*#__PURE__*/_jsxs(\"form\",{className:\"mt-3\",onSubmit:handleSubmit,children:[/*#__PURE__*/_jsxs(\"div\",{className:\"mb-3\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"form-label d-block\",children:\"Gender *\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex gap-3\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"form-check\",children:[/*#__PURE__*/_jsx(\"input\",{className:\"form-check-input\",type:\"radio\",name:\"gender\",id:\"gender-male\",value:\"male\",checked:form.gender==='male',onChange:handleChange,required:true}),/*#__PURE__*/_jsx(\"label\",{className:\"form-check-label\",htmlFor:\"gender-male\",children:\"Male\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-check\",children:[/*#__PURE__*/_jsx(\"input\",{className:\"form-check-input\",type:\"radio\",name:\"gender\",id:\"gender-female\",value:\"female\",checked:form.gender==='female',onChange:handleChange,required:true}),/*#__PURE__*/_jsx(\"label\",{className:\"form-check-label\",htmlFor:\"gender-female\",children:\"Female\"})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"mb-3\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"form-label\",children:\"Location\"}),/*#__PURE__*/_jsx(\"input\",{name:\"location\",value:form.location,onChange:handleChange,className:\"form-control\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"mb-3\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex justify-content-between align-items-center mb-1\",children:[/*#__PURE__*/_jsxs(\"label\",{className:\"form-label mb-0\",children:[\"Interests (select \",MIN_HABITS,\"-\",MAX_HABITS,\") *\"]}),/*#__PURE__*/_jsxs(\"small\",{className:\"text-muted\",children:[form.habits.length,\" selected\"]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"pill-grid selectable\",children:HABIT_OPTIONS.map(option=>{const selected=form.habits.includes(option);const disabled=!selected&&form.habits.length>=MAX_HABITS;return/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"pill \".concat(selected?'pill-selected':''),onClick:()=>handleHabitToggle(option),disabled:disabled,children:option},option);})}),/*#__PURE__*/_jsx(\"small\",{className:\"text-muted\",children:\"We\\u2019ll use these to improve AI roommate compatibility. Pick what genuinely matters to you.\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"mb-3\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex justify-content-between align-items-center mb-1\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"form-label mb-0\",children:\"My bio *\"}),/*#__PURE__*/_jsxs(\"small\",{className:\"text-muted\",children:[form.bio.length,\"/\",BIO_LIMIT]})]}),/*#__PURE__*/_jsx(\"input\",{name:\"bio\",value:form.bio,onChange:e=>{if(e.target.value.length<=BIO_LIMIT)handleChange(e);},className:\"form-control\",placeholder:\"Short sentence about you\",required:true})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"mb-3\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"form-label\",children:\"Profile photo\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex align-items-center gap-3\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"profile-avatar small\",children:displayImage?/*#__PURE__*/_jsx(\"img\",{src:displayImage,alt:\"Profile\",style:{objectPosition:\"\".concat(imagePosition.x,\"% \").concat(imagePosition.y,\"%\")}}):/*#__PURE__*/_jsx(\"span\",{children:\"?\"})}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex-grow-1\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"file\",accept:\"image/*\",className:\"form-control\",onChange:handlePhotoUpload,disabled:uploading}),/*#__PURE__*/_jsx(\"small\",{className:\"text-muted\",children:\"Upload one clear photo (max 5MB). A crop pop-up will help you center it.\"})]})]})]}),/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-primary\",type:\"submit\",disabled:saving,children:saving?'Saving...':'Save profile'})]})]})}),showCropper&&/*#__PURE__*/_jsx(\"div\",{className:\"cropper-overlay\",onMouseUp:endDrag,onMouseLeave:endDrag,children:/*#__PURE__*/_jsx(\"div\",{className:\"cropper-modal card shadow\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"card-body\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex justify-content-between align-items-center mb-2\",children:[/*#__PURE__*/_jsx(\"h5\",{className:\"mb-0\",children:\"Adjust your photo\"}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"btn-close\",\"aria-label\":\"Close\",onClick:handleCropCancel})]}),/*#__PURE__*/_jsx(\"p\",{className:\"text-muted small\",children:\"Drag inside the square to re-center your photo.\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"cropper-canvas\",onMouseMove:onCropMove,onMouseDown:startDrag,onMouseUp:endDrag,children:[/*#__PURE__*/_jsx(\"img\",{src:tempImage||displayImage,alt:\"Crop\",style:{objectPosition:\"\".concat(imagePosition.x,\"% \").concat(imagePosition.y,\"%\")}}),/*#__PURE__*/_jsx(\"div\",{className:\"cropper-frame\",style:{left:\"\".concat(imagePosition.x,\"%\"),top:\"\".concat(imagePosition.y,\"%\"),transform:'translate(-50%, -50%)'},children:/*#__PURE__*/_jsx(\"div\",{className:\"cropper-guide\"})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex justify-content-end gap-2 mt-3\",children:[/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"btn btn-outline-secondary\",onClick:handleCropCancel,children:\"Cancel\"}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"btn btn-primary\",onClick:handleCropSave,children:\"Save crop\"})]})]})})})]});}","map":{"version":3,"names":["React","useEffect","useMemo","useState","useNavigate","API","DEFAULT_PROPERTY_IMAGE","jsx","_jsx","jsxs","_jsxs","HABIT_OPTIONS","MIN_HABITS","MAX_HABITS","BIO_LIMIT","parseHabits","value","split","map","item","trim","filter","Boolean","formatHabits","list","join","calculateAge","birthdate","dob","Date","Number","isNaN","getTime","diff","now","ageDate","Math","abs","getUTCFullYear","cropImageToSquare","url","centerPercent","frameRatio","arguments","length","undefined","outputSize","Promise","resolve","reject","img","Image","crossOrigin","onload","naturalWidth","w","naturalHeight","h","size","min","centerX","x","centerY","y","startX","max","startY","canvas","document","createElement","width","height","ctx","getContext","drawImage","toDataURL","onerror","src","Profile","profile","setProfile","form","setForm","gender","location","bio","habits","profileImage","msg","setMsg","error","setError","loading","setLoading","saving","setSaving","uploading","setUploading","imagePosition","setImagePosition","showCropper","setShowCropper","tempImage","setTempImage","isDragging","setIsDragging","navigate","load","res","get","interests","data","savedPos","id","localStorage","getItem","concat","JSON","parse","slice","profile_image_url","err","_err$response","response","status","handleHabitToggle","habit","prev","alreadySelected","includes","_objectSpread","handleChange","e","target","name","persistProfileImage","age","payload","budget","put","_err$response2","_err$response2$data","console","message","handlePhotoUpload","event","files","Array","from","formData","FormData","append","_res$data","_res$data$urls","post","headers","urls","_err$response3","_err$response3$data","handleSubmit","preventDefault","setItem","stringify","_err$response4","_err$response4$data","ageDisplay","birthYear","getFullYear","displayImage","handleCropSave","base","cropped","handleCropCancel","startDrag","endDrag","onCropMove","rect","currentTarget","getBoundingClientRect","clientX","left","clientY","top","children","className","type","onClick","style","backgroundImage","backgroundPosition","backgroundSize","backgroundRepeat","onSubmit","checked","onChange","required","htmlFor","option","selected","disabled","placeholder","alt","objectPosition","accept","onMouseUp","onMouseLeave","onMouseMove","onMouseDown","transform"],"sources":["C:/Users/User/Documents/Project/Smart-roommate-app/client/src/components/Profile.js"],"sourcesContent":["import React, { useEffect, useMemo, useState } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport API from '../services/api';\nimport { DEFAULT_PROPERTY_IMAGE } from '../constants/propertyMedia';\n\nconst HABIT_OPTIONS = [\n  'Cinema',\n  'Football',\n  'Basketball',\n  'Tennis',\n  'Running',\n  'Cycling',\n  'Hiking',\n  'Swimming',\n  'Gym / Fitness',\n  'Yoga',\n  'Pilates',\n  'Cooking',\n  'Baking',\n  'Coffee shops',\n  'Tea lover',\n  'Wine tasting',\n  'Craft beer',\n  'Board games',\n  'Card games',\n  'Video games',\n  'Esports',\n  'Anime',\n  'Manga',\n  'Reading',\n  'Writing',\n  'Photography',\n  'Videography',\n  'Art galleries',\n  'Museums',\n  'Concerts',\n  'Live music',\n  'Festivals',\n  'Travel',\n  'Road trips',\n  'Camping',\n  'Beach days',\n  'Shopping',\n  'Thrifting',\n  'Fashion',\n  'Interior design',\n  'DIY projects',\n  'Gardening',\n  'Plants',\n  'Pets / Dogs',\n  'Pets / Cats',\n  'Volunteering',\n  'Meditation',\n  'Language learning',\n  'Tech & gadgets',\n  'Podcasts',\n  'Stand-up comedy',\n  'Dancing'\n];\n\nconst MIN_HABITS = 3;\nconst MAX_HABITS = 8;\nconst BIO_LIMIT = 30;\n\nconst parseHabits = (value) =>\n  (value || '')\n    .split(',')\n    .map((item) => item.trim())\n    .filter(Boolean);\n\nconst formatHabits = (list) => list.join(', ');\n\nconst calculateAge = (birthdate) => {\n  if (!birthdate) return null;\n  const dob = new Date(birthdate);\n  if (Number.isNaN(dob.getTime())) return null;\n  const diff = Date.now() - dob.getTime();\n  const ageDate = new Date(diff);\n  return Math.abs(ageDate.getUTCFullYear() - 1970);\n};\n\nconst cropImageToSquare = (url, centerPercent, frameRatio = 0.7, outputSize = 800) =>\n  new Promise((resolve, reject) => {\n    const img = new Image();\n    img.crossOrigin = 'anonymous';\n    img.onload = () => {\n      const { naturalWidth: w, naturalHeight: h } = img;\n      const size = Math.min(w, h) * frameRatio;\n      const centerX = (centerPercent.x / 100) * w;\n      const centerY = (centerPercent.y / 100) * h;\n      const startX = Math.min(Math.max(centerX - size / 2, 0), w - size);\n      const startY = Math.min(Math.max(centerY - size / 2, 0), h - size);\n\n      const canvas = document.createElement('canvas');\n      canvas.width = outputSize;\n      canvas.height = outputSize;\n      const ctx = canvas.getContext('2d');\n      ctx.drawImage(img, startX, startY, size, size, 0, 0, outputSize, outputSize);\n      resolve(canvas.toDataURL('image/jpeg', 0.9));\n    };\n    img.onerror = reject;\n    img.src = url;\n  });\n\nexport default function Profile() {\n  const [profile, setProfile] = useState(null);\n  const [form, setForm] = useState({\n    birthdate: '',\n    gender: '',\n    location: '',\n    bio: '',\n    habits: [],\n    profileImage: ''\n  });\n  const [msg, setMsg] = useState('');\n  const [error, setError] = useState('');\n  const [loading, setLoading] = useState(true);\n  const [saving, setSaving] = useState(false);\n  const [uploading, setUploading] = useState(false);\n  const [imagePosition, setImagePosition] = useState({ x: 50, y: 50 });\n  const [showCropper, setShowCropper] = useState(false);\n  const [tempImage, setTempImage] = useState('');\n  const [isDragging, setIsDragging] = useState(false);\n  const navigate = useNavigate();\n\n  useEffect(() => {\n    const load = async () => {\n      try {\n        const res = await API.get('/users/me');\n        const interests = parseHabits(res.data.habits);\n        setProfile(res.data);\n        const savedPos =\n          res.data.id && localStorage.getItem(`profileImagePos_${res.data.id}`)\n            ? JSON.parse(localStorage.getItem(`profileImagePos_${res.data.id}`))\n            : { x: 50, y: 50 };\n        setImagePosition(savedPos);\n        setForm({\n          birthdate: res.data.birthdate ? res.data.birthdate.slice(0, 10) : '2003-01-01',\n          gender: res.data.gender || '',\n          location: res.data.location || '',\n          bio: res.data.bio || '',\n          habits: interests,\n          profileImage: res.data.profile_image_url || ''\n        });\n      } catch (err) {\n        if (err.response?.status === 401) {\n          setError('Please log in to view your profile.');\n        } else {\n          setError('Unable to load your profile right now.');\n        }\n      } finally {\n        setLoading(false);\n      }\n    };\n    load();\n  }, []);\n\n  const handleHabitToggle = (habit) => {\n    setForm((prev) => {\n      const alreadySelected = prev.habits.includes(habit);\n      if (alreadySelected) {\n        return { ...prev, habits: prev.habits.filter((h) => h !== habit) };\n      }\n      if (prev.habits.length >= MAX_HABITS) return prev;\n      return { ...prev, habits: [...prev.habits, habit] };\n    });\n  };\n\n  const handleChange = (e) => setForm({ ...form, [e.target.name]: e.target.value });\n\n  const persistProfileImage = async (url) => {\n    const age = calculateAge(form.birthdate || profile?.birthdate || '2003-01-01');\n    const payload = {\n      birthdate: profile?.birthdate || '2003-01-01',\n      age,\n      gender: form.gender || profile?.gender || null,\n      location: form.location || profile?.location || '',\n      budget: null,\n      habits: formatHabits(form.habits),\n      profile_image_url: url,\n      bio: form.bio || profile?.bio || ''\n    };\n    try {\n      await API.put('/users/me', payload);\n      setProfile((prev) => ({ ...prev, ...payload }));\n    } catch (err) {\n      console.error(err);\n      setError(err.response?.data?.message || 'Unable to save photo.');\n    }\n  };\n\n  const handlePhotoUpload = async (event) => {\n    const files = Array.from(event.target.files || []);\n    if (!files.length) return;\n    const formData = new FormData();\n    formData.append('images', files[0]);\n    try {\n      setUploading(true);\n      const res = await API.post('/uploads', formData, { headers: { 'Content-Type': 'multipart/form-data' } });\n      const url = res.data?.urls?.[0];\n      if (url) {\n        setForm((prev) => ({ ...prev, profileImage: url }));\n        setTempImage(url);\n        setShowCropper(true);\n      }\n    } catch (err) {\n      console.error(err);\n      setError(err.response?.data?.message || 'Unable to upload photo.');\n    } finally {\n      setUploading(false);\n      event.target.value = '';\n    }\n  };\n\n  const handleSubmit = async (e) => {\n    e.preventDefault();\n    setMsg('');\n    setError('');\n\n    if (form.habits.length < MIN_HABITS || form.habits.length > MAX_HABITS) {\n      setError(`Choose at least ${MIN_HABITS} and at most ${MAX_HABITS} interests.`);\n      return;\n    }\n\n    if (!form.gender) {\n      setError('Please select your gender.');\n      return;\n    }\n\n    if (!form.bio.trim()) {\n      setError('Add a short bio about yourself (max 30 characters).');\n      return;\n    }\n\n    if (form.bio.trim().length > BIO_LIMIT) {\n      setError('Bio must be 30 characters or fewer.');\n      return;\n    }\n\n    const age = calculateAge(form.birthdate || profile?.birthdate || '2003-01-01');\n    const payload = {\n      birthdate: profile?.birthdate || '2003-01-01',\n      age,\n      gender: form.gender || null,\n      location: form.location || '',\n      budget: null,\n      habits: formatHabits(form.habits),\n      profile_image_url: form.profileImage || profile?.profile_image_url || null,\n      bio: form.bio.trim()\n    };\n\n    try {\n      setSaving(true);\n      await API.put('/users/me', payload);\n      setMsg('Profile updated');\n      setProfile((prev) => ({ ...prev, ...payload }));\n      if (profile?.id) {\n        localStorage.setItem(`profileImagePos_${profile.id}`, JSON.stringify(imagePosition));\n      }\n    } catch (err) {\n      console.error(err);\n      setError(err.response?.data?.message || 'Unable to update profile right now.');\n    } finally {\n      setSaving(false);\n    }\n  };\n\n  const ageDisplay = useMemo(() => calculateAge(form.birthdate || profile?.birthdate), [form.birthdate, profile]);\n  const birthYear = useMemo(\n    () => (profile?.birthdate ? new Date(profile.birthdate).getFullYear() : null),\n    [profile?.birthdate]\n  );\n  const displayImage = form.profileImage || profile?.profile_image_url || DEFAULT_PROPERTY_IMAGE;\n\n  const handleCropSave = async () => {\n    try {\n      const base = tempImage || displayImage;\n      const cropped = await cropImageToSquare(base, imagePosition, 0.65, 800);\n      setShowCropper(false);\n      await persistProfileImage(cropped);\n      setTempImage('');\n      setForm((prev) => ({ ...prev, profileImage: cropped }));\n      if (profile?.id) {\n        localStorage.setItem(`profileImagePos_${profile.id}`, JSON.stringify(imagePosition));\n      }\n    } catch (err) {\n      console.error(err);\n      setError('Unable to crop image.');\n      setShowCropper(false);\n    }\n  };\n\n  const handleCropCancel = () => {\n    setShowCropper(false);\n    setTempImage('');\n  };\n\n  const startDrag = () => setIsDragging(true);\n  const endDrag = () => setIsDragging(false);\n  const onCropMove = (e) => {\n    if (!isDragging) return;\n    const rect = e.currentTarget.getBoundingClientRect();\n    const x = ((e.clientX - rect.left) / rect.width) * 100;\n    const y = ((e.clientY - rect.top) / rect.height) * 100;\n    setImagePosition({ x: Math.min(100, Math.max(0, x)), y: Math.min(100, Math.max(0, y)) });\n  };\n\n  if (loading) return <div>Loading...</div>;\n\n  if (error && !profile) {\n    return (\n      <div className=\"alert alert-warning d-flex justify-content-between align-items-center\">\n        <span>{error}</span>\n        <button type=\"button\" className=\"btn btn-primary btn-sm\" onClick={() => navigate('/login')}>\n          Go to login\n        </button>\n      </div>\n    );\n  }\n\n  if (!profile) return null;\n\n  return (\n    <div className=\"profile-page\">\n      <div className=\"profile-hero-card shadow-sm\">\n        <div\n          className=\"profile-hero-image\"\n          style={{\n            backgroundImage: `url(${displayImage})`,\n            backgroundPosition: 'center',\n            backgroundSize: 'cover',\n            backgroundRepeat: 'no-repeat'\n          }}\n        >\n          <div className=\"profile-hero-overlay\">\n              <div className=\"d-flex align-items-center gap-2 mb-2\">\n                <span className=\"status-dot\"></span>\n                <span className=\"text-light small\">Online now</span>\n              </div>\n            <h2 className=\"text-light mb-1\">\n              {ageDisplay !== null ? `${profile.name}, ${ageDisplay}` : profile.name}\n            </h2>\n            {birthYear && <p className=\"mb-1 text-light small\">Born {birthYear}</p>}\n            {profile.location && <p className=\"mb-1 text-light\">{profile.location}</p>}\n            {form.bio && <p className=\"mb-2 text-light fw-semibold\">{form.bio}</p>}\n            {form.habits.length > 0 && (\n              <div className=\"pill-row\">\n                {form.habits.slice(0, 6).map((habit) => (\n                  <span key={habit} className=\"pill pill-selected small\">\n                    {habit}\n                  </span>\n                ))}\n              </div>\n            )}\n          </div>\n        </div>\n      </div>\n\n      <div className=\"card border-0 shadow-sm\">\n        <div className=\"card-body\">\n          <p className=\"eyebrow text-uppercase mb-1\">Improve your matches</p>\n          <h3 className=\"h5\">Update profile</h3>\n          {msg && <div className=\"alert alert-info mt-2\">{msg}</div>}\n          {error && profile && <div className=\"alert alert-warning mt-2\">{error}</div>}\n          <form className=\"mt-3\" onSubmit={handleSubmit}>\n            <div className=\"mb-3\">\n              <label className=\"form-label d-block\">Gender *</label>\n              <div className=\"d-flex gap-3\">\n                <div className=\"form-check\">\n                  <input\n                    className=\"form-check-input\"\n                    type=\"radio\"\n                    name=\"gender\"\n                    id=\"gender-male\"\n                    value=\"male\"\n                    checked={form.gender === 'male'}\n                    onChange={handleChange}\n                    required\n                  />\n                  <label className=\"form-check-label\" htmlFor=\"gender-male\">\n                    Male\n                  </label>\n                </div>\n                <div className=\"form-check\">\n                  <input\n                    className=\"form-check-input\"\n                    type=\"radio\"\n                    name=\"gender\"\n                    id=\"gender-female\"\n                    value=\"female\"\n                    checked={form.gender === 'female'}\n                    onChange={handleChange}\n                    required\n                  />\n                  <label className=\"form-check-label\" htmlFor=\"gender-female\">\n                    Female\n                  </label>\n                </div>\n              </div>\n            </div>\n            <div className=\"mb-3\">\n              <label className=\"form-label\">Location</label>\n              <input name=\"location\" value={form.location} onChange={handleChange} className=\"form-control\" />\n            </div>\n            <div className=\"mb-3\">\n              <div className=\"d-flex justify-content-between align-items-center mb-1\">\n                <label className=\"form-label mb-0\">Interests (select {MIN_HABITS}-{MAX_HABITS}) *</label>\n                <small className=\"text-muted\">{form.habits.length} selected</small>\n              </div>\n              <div className=\"pill-grid selectable\">\n                {HABIT_OPTIONS.map((option) => {\n                  const selected = form.habits.includes(option);\n                  const disabled = !selected && form.habits.length >= MAX_HABITS;\n                  return (\n                    <button\n                      type=\"button\"\n                      key={option}\n                      className={`pill ${selected ? 'pill-selected' : ''}`}\n                      onClick={() => handleHabitToggle(option)}\n                      disabled={disabled}\n                    >\n                      {option}\n                    </button>\n                  );\n                })}\n              </div>\n              <small className=\"text-muted\">\n                Weâ€™ll use these to improve AI roommate compatibility. Pick what genuinely matters to you.\n              </small>\n            </div>\n            <div className=\"mb-3\">\n              <div className=\"d-flex justify-content-between align-items-center mb-1\">\n                <label className=\"form-label mb-0\">My bio *</label>\n                <small className=\"text-muted\">{form.bio.length}/{BIO_LIMIT}</small>\n              </div>\n              <input\n                name=\"bio\"\n                value={form.bio}\n                onChange={(e) => {\n                  if (e.target.value.length <= BIO_LIMIT) handleChange(e);\n                }}\n                className=\"form-control\"\n                placeholder=\"Short sentence about you\"\n                required\n              />\n            </div>\n            <div className=\"mb-3\">\n              <label className=\"form-label\">Profile photo</label>\n              <div className=\"d-flex align-items-center gap-3\">\n                <div className=\"profile-avatar small\">\n                  {displayImage ? (\n                    <img\n                      src={displayImage}\n                      alt=\"Profile\"\n                      style={{ objectPosition: `${imagePosition.x}% ${imagePosition.y}%` }}\n                    />\n                  ) : (\n                    <span>?</span>\n                  )}\n                </div>\n                <div className=\"flex-grow-1\">\n                  <input\n                    type=\"file\"\n                    accept=\"image/*\"\n                    className=\"form-control\"\n                    onChange={handlePhotoUpload}\n                    disabled={uploading}\n                  />\n                  <small className=\"text-muted\">\n                    Upload one clear photo (max 5MB). A crop pop-up will help you center it.\n                  </small>\n                </div>\n              </div>\n            </div>\n            <button className=\"btn btn-primary\" type=\"submit\" disabled={saving}>\n              {saving ? 'Saving...' : 'Save profile'}\n            </button>\n          </form>\n        </div>\n      </div>\n\n      {showCropper && (\n        <div className=\"cropper-overlay\" onMouseUp={endDrag} onMouseLeave={endDrag}>\n          <div className=\"cropper-modal card shadow\">\n            <div className=\"card-body\">\n              <div className=\"d-flex justify-content-between align-items-center mb-2\">\n                <h5 className=\"mb-0\">Adjust your photo</h5>\n                <button type=\"button\" className=\"btn-close\" aria-label=\"Close\" onClick={handleCropCancel}></button>\n              </div>\n              <p className=\"text-muted small\">Drag inside the square to re-center your photo.</p>\n              <div\n                className=\"cropper-canvas\"\n                onMouseMove={onCropMove}\n                onMouseDown={startDrag}\n                onMouseUp={endDrag}\n              >\n                <img\n                  src={tempImage || displayImage}\n                  alt=\"Crop\"\n                  style={{ objectPosition: `${imagePosition.x}% ${imagePosition.y}%` }}\n                />\n                <div\n                  className=\"cropper-frame\"\n                  style={{ left: `${imagePosition.x}%`, top: `${imagePosition.y}%`, transform: 'translate(-50%, -50%)' }}\n                >\n                  <div className=\"cropper-guide\"></div>\n                </div>\n              </div>\n              <div className=\"d-flex justify-content-end gap-2 mt-3\">\n                <button type=\"button\" className=\"btn btn-outline-secondary\" onClick={handleCropCancel}>\n                  Cancel\n                </button>\n                <button type=\"button\" className=\"btn btn-primary\" onClick={handleCropSave}>\n                  Save crop\n                </button>\n              </div>\n            </div>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}